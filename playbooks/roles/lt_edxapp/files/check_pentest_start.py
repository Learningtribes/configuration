import os
import boto3
import time

ACCESS_KEY = os.environ['AWS_ACCESS_KEY_ID']
SECRET_KEY = os.environ['AWS_SECRET_ACCESS_KEY']
PENTEST_ID = os.environ['PENTEST_ID']

client = boto3.client('ec2', region_name='eu-west-1', aws_access_key_id=ACCESS_KEY, aws_secret_access_key=SECRET_KEY)

pentest_client = client.describe_instance_status(InstanceIds=[PENTEST_ID], IncludeAllInstances=True)

pentest_client_state = pentest_client['InstanceStatuses'][0]['InstanceState']['Name']
if pentest_client_state == 'stopped':
	client.start_instances(InstanceIds=[PENTEST_ID])
	time.sleep(300)